<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- iOS Safari -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <!-- Chrome, Firefox OS and Opera Status Bar Color -->
  <meta name="theme-color" content="#FFFFFF">
  <meta property="og:title" content="ClickHouse 编译">
    <meta name="description" content="ClickHouse的相关编译步骤。">
  <meta property="og:description" content="ClickHouse的相关编译步骤。">
    <meta property="og:type" content="blog">
  <title>ClickHouse 编译</title>
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css">
  <link rel="stylesheet" type="text/css"
    href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/themes/prism.min.css">
  <link rel="stylesheet" type="text/css" href="css/SourceSansPro.css">
  <link rel="stylesheet" type="text/css" href="css/notablog.css">
  <link rel="stylesheet" type="text/css" href="css/theme.css">
  <style>
    :root {
      font-size: 18px;
    }

    .DateTagBar {
      margin-top: 1.0rem;
    }
  </style>
</head>

<body>
  <nav class="Navbar">
    <a href="index.html">
      <div class="Navbar__Btn"><span><img class="inline-img-icon" src="https://avatars1.githubusercontent.com/u/32795735?s=400&u=40ed0595fb3044b01c47849f59ad96d69b4dc8db&v=4"></span> <span>Home</span></div>
    </a>
                                                                            <span class="Navbar__Delim">&centerdot;</span>
    <a href="2d54476c5d1d450da4b59ffb5969c773.html">
      <div class="Navbar__Btn"><span><img class="inline-img-icon" src="https://raw.githubusercontent.com/Rianico/Image/master/blog/4d148464df39c0fc356d1e7e02d76bcb.jpg"></span> <span>My Book</span></div>
    </a>
                                                <span class="Navbar__Delim">&centerdot;</span>
    <a href="a628b646a45b4fbd818394106dd16c24.html">
      <div class="Navbar__Btn"><span><img class="inline-img-icon" src="https://github.githubassets.com/favicons/favicon.svg"></span> <span>Github</span></div>
    </a>
          </nav>
  <header class="Header">
          <div class="Header__Cover">
        <img src="https://clickhouse.tech/images/index/intro.svg">
      </div>
          <div class="Header__Spacer ">
    </div>
        <div class="Header__Icon"><span><img class="inline-img-icon" src="https://clickhouse.tech/images/logo.svg"></span></div>
        <h1 class="Header__Title">ClickHouse 编译</h1>
            <div class="DateTagBar">
                <span class="DateTagBar__Item DateTagBar__Date">Posted on Thu, May 13, 2021</span>
                          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--orange">
            <a href="tag/Linux.html">Linux</a>
          </span>
                <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--purple">
            <a href="tag/ClickHouse.html">ClickHouse</a>
          </span>
                  </div>
          </header>
      <article id="https://www.notion.so/d600871e210c4b1eaafc544ae43ebc34" class="PageRoot PageRoot--FullWidth"><ul id="https://www.notion.so/bb3b8d1114a84d27bbac8cc5b4a4e824" class="ColorfulBlock ColorfulBlock--ColorGray TableOfContents"><li class="TableOfContents__Item"><a href="#https://www.notion.so/052bd4382c4847a7be251c03be6459a8"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">前言</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/53ca2dd090a24eadbb4b21ec00e6e5dd"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">1. 版本</strong></span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/a22ad681878240fbb26fcd0f824be0e1"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">1.1 ClickHouse</strong></span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/25bd4ea6daba47ff9197eaaece886548"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">1.2 安装 ninja</strong></span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/876978ddeacf4e80a84ca5aa9373deb2"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">1.3 安装 gcc</strong></span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/e707b5a8d19641ec8ba4924df51212b8"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">1.4 安装 cmake</strong></span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/6a4297e398244d64bb8b52dd0046e4b4"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">2. 编译</strong></span></span></div></a></li></ul><h2 id="https://www.notion.so/052bd4382c4847a7be251c03be6459a8" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/052bd4382c4847a7be251c03be6459a8"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">前言</span></span></h2><div id="https://www.notion.so/088b3a1dbb0443dbaff78f8a1eced6eb" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">应同事请求协助帮忙编译 ClickHouse，虽然个人对 ClickHouse 及 C++ 语言不熟悉，但编译其实万变不离其宗，把控好网络、组件版本、环境变量，再严格遵循官网编译步骤，其实可以解决绝大部分的软件编译问题。近年来也越来越多的开源软件添加了 Docker 的编译方式，确实可以解决绝大部分编译难题。</span></span></p></div><h2 id="https://www.notion.so/53ca2dd090a24eadbb4b21ec00e6e5dd" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/53ca2dd090a24eadbb4b21ec00e6e5dd"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">1. 版本</strong></span></span></h2><h3 id="https://www.notion.so/a22ad681878240fbb26fcd0f824be0e1" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/a22ad681878240fbb26fcd0f824be0e1"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">1.1 ClickHouse</strong></span></span></h3><div id="https://www.notion.so/3af049b9b7a34cb2a8b424bbba2d0fd4" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">拉取 ClickHouse 镜像，这里使用码云上的镜像进行加速：</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">git clone https://gitee.com/mirrors/clickhouse.git</code></span><span class="SemanticString">，并切换为 20.6.6.7 分支。</span></span></p></div><h3 id="https://www.notion.so/25bd4ea6daba47ff9197eaaece886548" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/25bd4ea6daba47ff9197eaaece886548"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">1.2 安装 ninja</strong></span></span></h3><div id="https://www.notion.so/fbf4efe11c2d4fc595288a0ce9439ff8" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">这里安装 ninja 1.9，参考ninja 官网：</span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="http://blog.fpliu.com/it/software/ninja">http://blog.fpliu.com/it/software/ninja</a></span><span class="SemanticString"> 。
ClickHouse 20.6.6.7 要求至少 1.8，这里直接按照 ninja 官网首页来：</span></span></p></div><pre id="https://www.notion.so/900f1598da77489a972e05b7ab820b4a" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span> curl -LO https://github.com/ninja-build/ninja/releases/download/v1.9.0/ninja-linux.zip
 unzip ninja-linux.zip -d ~/bin
 export PATH=$PATH:~/bin
 # 此处建立软连接，否则编译时会提示找不到 ninja
 ln -s ~/bin/ninja /usr/bin/ninja-build</span></span></span></code></pre><h3 id="https://www.notion.so/876978ddeacf4e80a84ca5aa9373deb2" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/876978ddeacf4e80a84ca5aa9373deb2"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">1.3 安装 gcc</strong></span></span></h3><div id="https://www.notion.so/9b625d126fa243038540a28c1fcf759c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">根据官网教程，ck 20.6.6.7 版本应使用 gcc-9，这里使用 devtoolset 来进行 gcc 版本的切换。</span></span></p></div><div id="https://www.notion.so/d7f6ea286dc74a2ba0a14ed67688b02e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">如果 gcc 版本不为 9，且安装了其他版本的 devtoolset，记得先卸载掉 devtoolset。</span></span></p></div><div id="https://www.notion.so/51f68ce1ca7a4493ac788b327e78a25d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">安装 devtoolset-9，并切换为 gcc-9，参照 </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://www.cnblogs.com/52fhy/p/12547521.html">https://www.cnblogs.com/52fhy/p/12547521.html</a></span><span class="SemanticString"> ：</span></span></p></div><pre id="https://www.notion.so/a12f1289e94c446e8b1bffb690678254" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span> yum -y install centos-release-scl
 yum -y install devtoolset-9-gcc devtoolset-9-gcc-c++ devtoolset-9-binutils
 scl enable devtoolset-9 bash</span></span></span></code></pre><h3 id="https://www.notion.so/e707b5a8d19641ec8ba4924df51212b8" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/e707b5a8d19641ec8ba4924df51212b8"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">1.4 安装 cmake</strong></span></span></h3><div id="https://www.notion.so/14efda7247854b428b8a4ab72c0f9c8d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">cmake 版本至少 3 以上：</span></span></p></div><pre id="https://www.notion.so/355efc5c476b43fab3c35b4615e3cd4e" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span> $ cmake --version
 cmake version 3.14.5</span></span></span></code></pre><h2 id="https://www.notion.so/6a4297e398244d64bb8b52dd0046e4b4" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/6a4297e398244d64bb8b52dd0046e4b4"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">2. 编译</strong></span></span></h2><div id="https://www.notion.so/f0ef181b7d6642e0af1f81ad7ba8de2a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">重点</strong></span><span class="SemanticString">：在前面规整了各编译组件的版本后，本质上还出现编译错误的原因都是 </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">ClickHouse 的依赖包下载不全或者下载错误</strong></span><span class="SemanticString">，这里通过修改 ClickHouse 依赖的子模块为码云 gitee 仓库解决。</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/a040e9001a1846daa999fc9471387cb2" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">码云为编译 ClickHouse 所建的镜像仓库（优先使用）：</span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://gitee.com/organizations/ClickHouse-Build/projects">https://gitee.com/organizations/ClickHouse-Build/projects</a></span></span></li><li id="https://www.notion.so/b90339cbfd3d4022bec8a1dedd9b90ee" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">码云为绝大部分 github 项目建立的镜像仓库：</span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://gitee.com/organizations/mirrors/projects">https://gitee.com/organizations/mirrors/projects</a></span></span></li><li id="https://www.notion.so/0e59c21b4d0245989a8a9c5302461c3a" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">码云为 apache 项目建立的镜像仓库：</span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://gitee.com/organizations/mirrors_apache/projects">https://gitee.com/organizations/mirrors_apache/projects</a></span></span></li></ul><div id="https://www.notion.so/0b08541c1b864c00a3a5c5649cd12fbd" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">上述几个仓库，都是码云官方拉取了 github 上的仓库，为国内提供加速的。</span></span></p></div><div id="https://www.notion.so/f78f8f8deffc4889975496e0b62ffd91" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">知道这上面三个仓库后，我们需要做的就是将 ClickHouse 依赖的子项目配置及其子项目依赖的子项目（部分子项目也有自身依赖的子项目）替换为码云上的仓库：</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">sed -i -r  &quot;s/github.com\/.+\//gitee.com\/ClickHouse-Build\//g&quot; .gitmodules</code></span><span class="SemanticString">。</span></span></p></div><blockquote id="https://www.notion.so/8337400d3a464258b61842b5e0dad4e2" class="ColorfulBlock ColorfulBlock--ColorDefault Quote"><span class="SemanticStringArray"><span class="SemanticString">NOTE：上述命令只是举个例子，实际上需要根据具体场景，将各个 git 项目下的 github 路径替换为 gitee 路径。之所以列出三个镜像仓库，是因为部分子项目在 ClickHouse-Build 中也没有，此时需要到剩余两个仓库中寻找并手动替换。当然更好的方法是能够搭建一个 vpn，这样就无需自己手动替换了。</span></span></blockquote><blockquote id="https://www.notion.so/a0f187a504934331b6bd848e403444e4" class="ColorfulBlock ColorfulBlock--ColorDefault Quote"><span class="SemanticStringArray"><span class="SemanticString">NOTE：子项目的含义请自行了解 git 的 submodule 概念。</span></span></blockquote><div id="https://www.notion.so/c041feaf460d4e0e8cc868dee15cff26" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">替换完成后，在 ClickHouse 顶级目录执行 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">git submodule sync --recursive</code></span><span class="SemanticString"> 同步修改的子项目配置，之后再执行 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">git submodule update --init --recursive</code></span><span class="SemanticString"> 拉取子项目，根据报错提示，逐个修改子模块的仓库路径。</span></span></p></div><div id="https://www.notion.so/1838cb1eca854843846e66698b506238" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">需要注意的是，有部分子项目的项目命名在 gitee 跟 github 上有一点区别，这里逐个列出：</span></span></p></div><pre id="https://www.notion.so/22c59de8fd104b76a44d78ed1be58233" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span> # vim $ClickHouse_HOME/.gitmodules
 
 [submodule &quot;contrib/aws&quot;]
     path = contrib/aws
     url = https://github.com/ClickHouse-Extras/aws-sdk-cpp.git
 # 替换为
 [submodule &quot;contrib/aws&quot;]
         path = contrib/aws
         url = https://gitee.com/ClickHouse-Build/aws.git</span></span></span></code></pre><div id="https://www.notion.so/5398288cfcda48c5abe1d0a5b4ef4d46" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">最后在 ClickHouse 顶级目录执行下列命令进行编译：</span></span></p></div><pre id="https://www.notion.so/92c99629ae7b4d1cb962e9640a1d3b73" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span> # 参考：https://clickhouse.tech/docs/v20.3/en/development/build/
 $ export CC=gcc-9
 $ export CXX=g++-9
 $ cd ClickHouse
 $ mkdir build
 $ cd build
 # 执行 cmake 的时候，一定要仔细观察输出信息，详见下述文字详细说明
 $ cmake ..
 $ ninja clickhouse
 $ cd ..</span></span></span></code></pre><div id="https://www.notion.so/71a03763d9b54be9a8036db83c517e10" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">执行 cmake 的时候，一定要仔细观察输出信息，若出现下述信息：</span></span></p></div><pre id="https://www.notion.so/c2de19b4b39e495f941bf53d9942a41b" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span> ......
 -- The following OPTIONAL packages have not been found:
 
  * Arrow
  * Parquet
 ......</span></span></span></code></pre><div id="https://www.notion.so/46f5bffffb3949f19a9a347ed811ac06" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">那么需要仔细检查 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">$ClickHouse_HOME/contrib</code></span><span class="SemanticString"> 下对应的模块是否存在，以及 .gitmodules 对应模块的配置是否正确，否则会导致编译失败。
如果发现模块拉取失败，则可以删除 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">$ClickHouse_HOME/contrib/模块</code></span><span class="SemanticString"> 的文件夹，然后重新执行 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">git submodule sync --recursive</code></span><span class="SemanticString"> 以及 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">git submodule update --init --recursive</code></span><span class="SemanticString"> 重新拉取模块。</span></span></p></div><div id="https://www.notion.so/d3f025aaaf004228b4326cd029a1cfbf" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">最后会生成  </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">$ClickHouse_HOME/build/programs/clickhouse</code></span><span class="SemanticString"> 可执行文件，用于启动 client、server 等。</span></span></p></div><div id="https://www.notion.so/f2af7d99c1f04974b2bf3810e87dcb16" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">官网教程： </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://gitee.com/ClickHouse-Build/aws.git">https://gitee.com/ClickHouse-Build/aws.git</a></span></span></p></div></article>  <footer class="Footer">
        <div>&copy; Rianico‘s Blog 2019</div>
        <div>&centerdot;</div>
        <div>Powered by <a href="https://github.com/dragonman225/notablog" target="_blank"
            rel="noopener noreferrer">Notablog</a>.
        </div>
    </footer>
</body>

</html>